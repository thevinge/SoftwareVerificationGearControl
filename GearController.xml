<?xml version="1.0" encoding="utf-8"?><!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'><nta><declaration>// Place global declarations here.
chan OpenClutch;
chan ClutchIsOpen;
chan CloseClutch;
chan ClutchIsClosed;
chan NewGear;
chan ReqNewGear;
chan GearNeu;
chan ReqSet;
chan ReqNeu;
chan ReqZeroTorque;
chan ReqTorque;
chan TorqueZero;
chan ReqSpeed;
chan SpeedSet;
chan GearSet;

clock SysTimer;

int ErrStat;
int ToGear;
int FromGear;
int UseCase;
clock CTimer;
clock GBTimer;
clock ETimer;
clock GCTimer;</declaration><template><name x="5" y="5">Clutch</name><declaration>// Place local declarations here.


</declaration><location id="id0" x="-928" y="-336"><name x="-976" y="-320">ErrorOpen</name></location><location id="id1" x="-840" y="-328"><name x="-850" y="-358">ErrorClose</name></location><location id="id2" x="-1032" y="-256"><name x="-1088" y="-288">Closed</name></location><location id="id3" x="-744" y="-256"><name x="-728" y="-280">Closing</name><label kind="invariant" x="-754" y="-241">CTimer&lt;=150</label></location><location id="id4" x="-744" y="-400"><name x="-754" y="-430">Open</name></location><location id="id5" x="-1032" y="-400"><name x="-1048" y="-448">Opening</name><label kind="invariant" x="-1064" y="-432">CTimer &lt;= 150</label></location><init ref="id2"/><transition><source ref="id3"/><target ref="id1"/><label kind="guard" x="-888" y="-304">CTimer==150</label><label kind="assignment" x="-864" y="-288">ErrStat=1</label></transition><transition><source ref="id4"/><target ref="id3"/><label kind="synchronisation" x="-736" y="-344">CloseClutch?</label><label kind="assignment" x="-736" y="-328">CTimer=0</label></transition><transition><source ref="id5"/><target ref="id0"/><label kind="guard" x="-976" y="-392">CTimer==150</label><label kind="assignment" x="-968" y="-376">ErrStat=2</label></transition><transition><source ref="id5"/><target ref="id4"/><label kind="guard" x="-936" y="-440">CTimer &gt;= 100</label><label kind="synchronisation" x="-936" y="-424">ClutchIsOpen!</label><nail x="-760" y="-400"/></transition><transition><source ref="id3"/><target ref="id2"/><label kind="guard" x="-952" y="-248">CTimer&gt;=100</label><label kind="synchronisation" x="-952" y="-232">ClutchIsClosed!</label></transition><transition><source ref="id2"/><target ref="id5"/><label kind="synchronisation" x="-1120" y="-344">OpenClutch?</label><label kind="assignment" x="-1112" y="-328">CTimer=0</label></transition></template><template><name>Interface</name><location id="id6" x="344" y="696"><name x="328" y="712">Gear5</name></location><location id="id7" x="416" y="624"><name x="440" y="608">chkGear45</name></location><location id="id8" x="256" y="600"><name x="160" y="592">chkGear54</name></location><location id="id9" x="344" y="520"><name x="376" y="512">Gear4</name></location><location id="id10" x="408" y="424"><name x="440" y="416">chkGear34</name></location><location id="id11" x="280" y="400"><name x="168" y="392">chkGear43</name></location><location id="id12" x="336" y="312"><name x="368" y="304">Gear3</name></location><location id="id13" x="416" y="240"><name x="448" y="232">chkGear23</name></location><location id="id14" x="248" y="232"><name x="144" y="224">chkGear32</name></location><location id="id15" x="344" y="144"><name x="376" y="136">Gear2</name></location><location id="id16" x="440" y="32"><name x="464" y="24">chkGear12</name></location><location id="id17" x="272" y="32"><name x="184" y="24">chkGear21</name></location><location id="id18" x="352" y="-96"><name x="384" y="-104">Gear1</name></location><location id="id19" x="152" y="-56"><name x="112" y="-32">chkGear1N</name></location><location id="id20" x="144" y="-176"><name x="112" y="-216">chkGearN1</name></location><location id="id21" x="-104" y="128"><name x="-128" y="152">GearR</name></location><location id="id22" x="-40" y="32"><name x="-32" y="40">chkGearNR</name></location><location id="id23" x="-144" y="24"><name x="-240" y="8">chkGearRN</name></location><location id="id24" x="-96" y="-80"><name x="-106" y="-110">GearN</name></location><init ref="id24"/><transition><source ref="id8"/><target ref="id9"/><label kind="synchronisation" x="232" y="536">NewGear?</label></transition><transition><source ref="id6"/><target ref="id8"/><label kind="synchronisation" x="208" y="648">ReqNewGear!</label><label kind="assignment" x="216" y="664">FromGear=5,
ToGear=4</label></transition><transition><source ref="id7"/><target ref="id6"/><label kind="synchronisation" x="392" y="656">NewGear?</label></transition><transition><source ref="id9"/><target ref="id7"/><label kind="synchronisation" x="408" y="536">ReqNewGear!</label><label kind="assignment" x="408" y="552">FromGear=4,
ToGear=5</label></transition><transition><source ref="id11"/><target ref="id12"/><label kind="synchronisation" x="240" y="336">NewGear?</label></transition><transition><source ref="id9"/><target ref="id11"/><label kind="synchronisation" x="224" y="472">ReqNewGear!</label><label kind="assignment" x="232" y="488">FromGear=4,
ToGear=3</label></transition><transition><source ref="id10"/><target ref="id9"/><label kind="synchronisation" x="392" y="464">NewGear?</label></transition><transition><source ref="id12"/><target ref="id10"/><label kind="synchronisation" x="384" y="336">ReqNewGear!</label><label kind="assignment" x="392" y="352">FromGear=3,
ToGear=4</label></transition><transition><source ref="id14"/><target ref="id15"/><label kind="synchronisation" x="224" y="176">NewGear?</label></transition><transition><source ref="id12"/><target ref="id14"/><label kind="synchronisation" x="200" y="272">ReqNewGear!</label><label kind="assignment" x="200" y="288">FromGear=3,
ToGear=2</label></transition><transition><source ref="id13"/><target ref="id12"/><label kind="synchronisation" x="392" y="272">NewGear?</label></transition><transition><source ref="id15"/><target ref="id13"/><label kind="synchronisation" x="424" y="152">ReqNewGear!</label><label kind="assignment" x="424" y="168">FromGear=2,
ToGear=3</label></transition><transition><source ref="id17"/><target ref="id18"/><label kind="synchronisation" x="304" y="-16">NewGear?</label></transition><transition><source ref="id15"/><target ref="id17"/><label kind="synchronisation" x="224" y="88">ReqNewGear!</label><label kind="assignment" x="224" y="104">FromGear=2,
ToGear=1</label></transition><transition><source ref="id16"/><target ref="id15"/><label kind="synchronisation" x="400" y="80">NewGear?</label></transition><transition><source ref="id18"/><target ref="id16"/><label kind="synchronisation" x="408" y="-72">ReqNewGear!</label><label kind="assignment" x="408" y="-56">FromGear=1,
ToGear=2</label></transition><transition><source ref="id18"/><target ref="id19"/><label kind="synchronisation" x="200" y="-104">ReqNewGear!</label><label kind="assignment" x="208" y="-64">FromGear=1,
ToGear=0</label></transition><transition><source ref="id20"/><target ref="id18"/><label kind="synchronisation" x="240" y="-160">NewGear?</label></transition><transition><source ref="id19"/><target ref="id24"/><label kind="synchronisation" x="32" y="-96">NewGear?</label></transition><transition><source ref="id24"/><target ref="id20"/><label kind="synchronisation" x="-40" y="-184">ReqNewGear!</label><label kind="assignment" x="-40" y="-168">FromGear=0,
ToGear=1</label></transition><transition><source ref="id21"/><target ref="id23"/><label kind="synchronisation" x="-224" y="64">ReqNewGear!</label><label kind="assignment" x="-216" y="88">FromGear=6,
ToGear=0</label></transition><transition><source ref="id22"/><target ref="id21"/><label kind="synchronisation" x="-56" y="80">NewGear?</label></transition><transition><source ref="id24"/><target ref="id22"/><label kind="synchronisation" x="-48" y="-48">ReqNewGear!</label><label kind="assignment" x="-48" y="-32">FromGear=0,
ToGear=6</label></transition><transition><source ref="id23"/><target ref="id24"/><label kind="synchronisation" x="-180" y="-43">NewGear?</label></transition></template><template><name>GearBox</name><location id="id25" x="8" y="-104"><name x="-8" y="-88">ErrorNeu</name></location><location id="id26" x="-72" y="-120"><name x="-104" y="-152">ErrorIdle</name></location><location id="id27" x="-192" y="-24"><name x="-216" y="-8">Closing</name><label kind="invariant" x="-216" y="8">(GBTimer&lt;=300)</label></location><location id="id28" x="128" y="-24"><name x="152" y="-32">Idle</name></location><location id="id29" x="128" y="-184"><name x="112" y="-232">Opening</name><label kind="invariant" x="112" y="-216">(GBTimer&lt;=200)</label></location><location id="id30" x="-192" y="-184"><name x="-224" y="-216">Neutral</name></location><init ref="id30"/><transition><source ref="id28"/><target ref="id29"/><label kind="synchronisation" x="136" y="-120">ReqNeu?</label><label kind="assignment" x="136" y="-104">GBTimer:=0</label></transition><transition><source ref="id27"/><target ref="id28"/><label kind="guard" x="-96" y="-24">GBTimer&gt;=100</label><label kind="synchronisation" x="-96" y="-8">GearSet!</label></transition><transition><source ref="id29"/><target ref="id25"/><label kind="guard" x="-16" y="-160">GBTimer&gt;200</label><label kind="assignment" x="-16" y="-144">ErrStat:=4</label></transition><transition><source ref="id27"/><target ref="id26"/><label kind="guard" x="-128" y="-80">GBTimer==300</label><label kind="assignment" x="-128" y="-64">ErrStat:=3</label></transition><transition><source ref="id29"/><target ref="id30"/><label kind="guard" x="-96" y="-224">GBTimer&gt;=100</label><label kind="synchronisation" x="-96" y="-208">GearNeu!</label></transition><transition><source ref="id30"/><target ref="id27"/><label kind="synchronisation" x="-252" y="-119">ReqSet?</label><label kind="assignment" x="-272" y="-104">GBTimer:=0</label></transition></template><template><name>Engine</name><declaration>
</declaration><location id="id31" x="-24" y="0"><name x="-72" y="-40">ClutchOpen</name><committed/></location><location id="id32" x="-192" y="0"><name x="-232" y="16">ClutchClose</name><label kind="invariant" x="-232" y="32">ETimer&lt;=900</label></location><location id="id33" x="-192" y="248"><name x="-176" y="216">ErrorSpeed</name></location><location id="id34" x="-288" y="176"><name x="-392" y="144">Speed</name><label kind="invariant" x="-392" y="160">ETimer&lt;=500</label></location><location id="id35" x="-24" y="176"><name x="-32" y="192">FindSpeed</name><label kind="invariant" x="-32" y="208">ETimer&lt;=200</label></location><location id="id36" x="184" y="176"><name x="200" y="168">Zero</name></location><location id="id37" x="184" y="-160"><name x="174" y="-190">DecTorque</name><label kind="invariant" x="174" y="-145">ETimer&lt;=400</label></location><location id="id38" x="-288" y="-160"><name x="-328" y="-192">Torque</name></location><location id="id39" x="96" y="32"><name x="86" y="2">Initial</name></location><init ref="id39"/><transition><source ref="id36"/><target ref="id35"/><label kind="guard" x="76" y="184">ToGear&gt;0</label><label kind="synchronisation" x="72" y="201">ReqSpeed?</label><label kind="assignment" x="72" y="216">ETimer=0</label></transition><transition><source ref="id32"/><target ref="id33"/><label kind="guard" x="-184" y="80">ETimer==900</label></transition><transition><source ref="id35"/><target ref="id31"/><label kind="guard" x="-112" y="32">ETimer==200</label><label kind="assignment" x="-104" y="48">UseCase=2</label></transition><transition><source ref="id31"/><target ref="id32"/><label kind="guard" x="-144" y="-24">ToGear&gt;0</label><label kind="assignment" x="-144" y="-40">ETimer=0</label></transition><transition><source ref="id37"/><target ref="id31"/><label kind="guard" x="12" y="-110">ETimer==400</label><label kind="assignment" x="8" y="-96">UseCase=1</label></transition><transition><source ref="id31"/><target ref="id39"/><label kind="guard" x="8" y="-8">ToGear==0</label></transition><transition><source ref="id36"/><target ref="id39"/><label kind="guard" x="80" y="74">ToGear==0</label></transition><transition><source ref="id37"/><target ref="id36"/><label kind="guard" x="192" y="-8">ETimer&gt;=150</label><label kind="synchronisation" x="192" y="-24">TorqueZero!</label></transition><transition><source ref="id38"/><target ref="id37"/><label kind="synchronisation" x="-128" y="-208">ReqZeroTorque?</label><label kind="assignment" x="-128" y="-192">ETimer=0,
UseCase=0</label></transition><transition><source ref="id32"/><target ref="id38"/><label kind="guard" x="-232" y="-120">ETimer&gt;=50</label><label kind="synchronisation" x="-232" y="-105">ReqTorque?</label></transition><transition><source ref="id34"/><target ref="id38"/><label kind="guard" x="-376" y="-24">ETimer&lt;500</label><label kind="synchronisation" x="-376" y="-40">ReqTorque?</label></transition><transition><source ref="id34"/><target ref="id33"/><label kind="guard" x="-300" y="182">ETimer==500</label></transition><transition><source ref="id35"/><target ref="id34"/><label kind="guard" x="-160" y="128">ETimer&gt;=50</label><label kind="synchronisation" x="-160" y="144">SpeedSet!</label><label kind="assignment" x="-160" y="160">ETimer=0</label></transition><transition><source ref="id39"/><target ref="id35"/><label kind="synchronisation" x="-8" y="72">ReqSpeed?</label><label kind="assignment" x="-8" y="88">ETimer = 0,
UseCase = 0</label></transition></template><template><name>GearControl</name><location id="id40" x="176" y="536"><name x="136" y="504">CCloseError</name></location><location id="id41" x="248" y="592"><name x="328" y="576">CheckClutchClosed2</name><label kind="invariant" x="328" y="592">(GCTimer&lt;=200)</label></location><location id="id42" x="-72" y="592"><name x="-64" y="560">GearChanged</name><committed/></location><location id="id43" x="128" y="400"><name x="118" y="370">GSetError</name></location><location id="id44" x="-72" y="320"><name x="-184" y="312">ReqSetGear</name><committed/></location><location id="id45" x="-72" y="488"><name x="-192" y="480">ReqTorqueC</name><committed/></location><location id="id46" x="-72" y="400"><name x="-192" y="392">CheckGearSet1</name><label kind="invariant" x="-208" y="408">(GCTimer&lt;=350)</label></location><location id="id47" x="96" y="488"><name x="48" y="440">CheckClutchClosed</name><label kind="invariant" x="48" y="456">(GCTimer&lt;=200)</label></location><location id="id48" x="328" y="488"><name x="352" y="472">ClutchClose</name><committed/></location><location id="id49" x="328" y="400"><name x="344" y="384">CheckGearSet2</name><label kind="invariant" x="344" y="408">(GCTimer&lt;=350)</label></location><location id="id50" x="328" y="312"><name x="320" y="280">ClutchOpen</name><committed/></location><location id="id51" x="192" y="240"><name x="104" y="248">CheckClutch</name><label kind="invariant" x="104" y="264">GCTimer&lt;=200</label></location><location id="id52" x="-72" y="240"><name x="-64" y="248">CheckSyncSpeed</name><label kind="invariant" x="-64" y="264">GCTimer&lt;=155</label></location><location id="id53" x="408" y="200"><name x="424" y="176">ReqSetGear2</name><committed/></location><location id="id54" x="-72" y="160"><name x="-56" y="136">ReqSyncSpeed</name><committed/></location><location id="id55" x="408" y="104"><name x="424" y="88">CheckGearNeu2</name><label kind="invariant" x="424" y="104">GCTimer&lt;=250</label></location><location id="id56" x="232" y="104"><name x="232" y="120">GNeuError</name></location><location id="id57" x="-72" y="80"><name x="-176" y="40">CheckGearNeu</name><label kind="invariant" x="-176" y="56">GCTimer&lt;=250</label></location><location id="id58" x="-72" y="0"><name x="-56" y="-32">ReqNeuGear</name><committed/></location><location id="id59" x="192" y="40"><name x="200" y="8">COpenError</name></location><location id="id60" x="408" y="8"><name x="416" y="-24">ClutchOpen2</name><committed/></location><location id="id61" x="192" y="-88"><name x="168" y="-136">CheckClutch2</name><label kind="invariant" x="168" y="-120">GCTimer&lt;=200</label></location><location id="id62" x="-72" y="-88"><name x="-56" y="-88">CheckTorque</name><label kind="invariant" x="-56" y="-72">GCTimer&lt;=255</label></location><location id="id63" x="-72" y="-176"><name x="-56" y="-200">Initiate</name><committed/></location><location id="id64" x="-72" y="-256"><name x="-64" y="-288">Gear</name></location><init ref="id64"/><transition><source ref="id42"/><target ref="id64"/><label kind="synchronisation" x="-280" y="136">NewGear!</label><nail x="-280" y="576"/><nail x="-280" y="0"/><nail x="-272" y="-216"/></transition><transition><source ref="id54"/><target ref="id42"/><label kind="guard" x="-200" y="168">ToGear&lt;=0</label><nail x="-224" y="216"/><nail x="-224" y="528"/></transition><transition><source ref="id53"/><target ref="id41"/><label kind="guard" x="488" y="384">ToGear==0</label><label kind="synchronisation" x="488" y="408">CloseClutch!</label><label kind="assignment" x="488" y="432">GCTimer:=0</label><nail x="464" y="224"/><nail x="480" y="560"/></transition><transition><source ref="id53"/><target ref="id49"/><label kind="guard" x="400" y="248">ToGear&gt;0</label><label kind="synchronisation" x="408" y="264">ReqSet!</label><label kind="assignment" x="416" y="280">GCTimer:=0</label><nail x="408" y="336"/></transition><transition><source ref="id41"/><target ref="id40"/><label kind="guard" x="240" y="536">GCTimer&gt;150 &amp;&amp;
GCTimer&lt;=200</label><nail x="232" y="544"/></transition><transition><source ref="id47"/><target ref="id40"/><label kind="guard" x="8" y="512">GCTimer&gt;150 &amp;&amp;
GCTimer&lt;=200</label><nail x="120" y="528"/></transition><transition><source ref="id41"/><target ref="id42"/><label kind="synchronisation" x="32" y="592">ClutchIsClosed?</label></transition><transition><source ref="id45"/><target ref="id42"/><label kind="synchronisation" x="-132" y="525">ReqTorque!</label></transition><transition><source ref="id47"/><target ref="id45"/><label kind="synchronisation" x="-64" y="464">ClutchIsClosed?</label></transition><transition><source ref="id46"/><target ref="id45"/><label kind="synchronisation" x="-132" y="429">GearSet?</label></transition><transition><source ref="id49"/><target ref="id43"/><label kind="guard" x="192" y="368">GCTimer&gt;300 &amp;&amp;
GCTimer&lt;=350</label></transition><transition><source ref="id46"/><target ref="id43"/><label kind="guard" x="-24" y="368">GCTimer&gt;300 &amp;&amp;
GCTimer&lt;=350</label></transition><transition><source ref="id44"/><target ref="id46"/><label kind="synchronisation" x="-136" y="344">ReqSet!</label><label kind="assignment" x="-132" y="360">GCTimer=0</label></transition><transition><source ref="id52"/><target ref="id44"/><label kind="guard" x="-176" y="256">GCTimer&lt;150</label><label kind="synchronisation" x="-160" y="272">SpeedSet?</label></transition><transition><source ref="id48"/><target ref="id47"/><label kind="synchronisation" x="224" y="488">CloseClutch!</label><label kind="assignment" x="224" y="504">GCTimer:=0</label></transition><transition><source ref="id49"/><target ref="id48"/><label kind="synchronisation" x="268" y="429">GearSet?</label></transition><transition><source ref="id50"/><target ref="id49"/><label kind="synchronisation" x="336" y="336">ReqSet!</label><label kind="assignment" x="336" y="352">GCTimer:=0</label></transition><transition><source ref="id51"/><target ref="id50"/><label kind="synchronisation" x="272" y="232">ClutchIsOpen?</label><nail x="264" y="232"/></transition><transition><source ref="id51"/><target ref="id59"/><label kind="guard" x="200" y="144">GCTimer&gt;150 &amp;&amp; 
GCTimer&lt;=200</label></transition><transition><source ref="id52"/><target ref="id51"/><label kind="guard" x="40" y="184">GCTimer&gt;=150</label><label kind="synchronisation" x="40" y="199">OpenClutch!</label><label kind="assignment" x="40" y="214">GCTimer=0</label></transition><transition><source ref="id54"/><target ref="id52"/><label kind="guard" x="-64" y="168">ToGear&gt;0</label><label kind="synchronisation" x="-64" y="184">ReqSpeed!</label><label kind="assignment" x="-64" y="200">GCTimer=0</label></transition><transition><source ref="id55"/><target ref="id53"/><label kind="synchronisation" x="416" y="136">GearNeu?</label></transition><transition><source ref="id63"/><target ref="id54"/><label kind="guard" x="-192" y="-184">FromGear&lt;=0</label><nail x="-192" y="-136"/><nail x="-192" y="96"/></transition><transition><source ref="id57"/><target ref="id54"/><label kind="synchronisation" x="-64" y="104">GearNeu?</label></transition><transition><source ref="id55"/><target ref="id56"/><label kind="guard" x="288" y="72">GCTimer&gt;200 &amp;&amp;
GCTimer&lt;=250</label></transition><transition><source ref="id60"/><target ref="id55"/><label kind="synchronisation" x="432" y="32">ReqNeu!</label><label kind="assignment" x="424" y="48">GCTimer=0</label></transition><transition><source ref="id57"/><target ref="id56"/><label kind="guard" x="96" y="64">GCTimer&gt;200 &amp;&amp;
GCTimer&lt;=250</label><nail x="88" y="80"/><nail x="88" y="104"/></transition><transition><source ref="id58"/><target ref="id57"/><label kind="synchronisation" x="-64" y="17">ReqNeu!</label><label kind="assignment" x="-64" y="32">GCTimer=0</label></transition><transition><source ref="id62"/><target ref="id58"/><label kind="guard" x="-168" y="-63">GCTimer&lt;250</label><label kind="synchronisation" x="-168" y="-48">TorqueZero?</label></transition><transition><source ref="id61"/><target ref="id59"/><label kind="guard" x="192" y="-48">GCTimer&gt;150 &amp;&amp;
GCTimer&lt;=200</label></transition><transition><source ref="id61"/><target ref="id60"/><label kind="synchronisation" x="272" y="-112">ClutchIsOpen?</label><nail x="360" y="-88"/><nail x="384" y="-88"/><nail x="408" y="-64"/><nail x="408" y="-48"/><nail x="408" y="-48"/><nail x="408" y="-40"/></transition><transition><source ref="id62"/><target ref="id61"/><label kind="guard" x="56" y="-135">GCTimer&gt;=250</label><label kind="synchronisation" x="56" y="-120">OpenClutch!</label><label kind="assignment" x="56" y="-105">GCTimer=0</label></transition><transition><source ref="id63"/><target ref="id62"/><label kind="guard" x="-64" y="-167">FromGear&gt;0</label><label kind="synchronisation" x="-64" y="-152">ReqZeroTorque!</label><label kind="assignment" x="-64" y="-137">GCTimer=0</label></transition><transition><source ref="id64"/><target ref="id63"/><label kind="synchronisation" x="-64" y="-240">ReqNewGear?</label><label kind="assignment" x="-64" y="-224">SysTimer=0</label></transition></template><system>// List one or more processes to be composed into a system.
system Clutch, Interface, GearBox, Engine, GearControl;</system></nta>